# Neutron-star-relativistic-ray-tracing-code-comparisons

## Overview
This repository contains synthetic neutron star X-ray pulse profile datasets generated by the different relativistic ray-tracing codes ([X-PSI](https://github.com/xpsi-group/xpsi), IM, Alberta) and the python notebook for reproducing the comparisons demonstrated in the publication "Exploring Waveform Variations among Neutron Star Ray-tracing Codes for Complex Emission Geometries" by Choudhury et al. (2024; [ApJ 975 202](https://doi.org/10.3847/1538-4357/ad7255); [arXiv:2407.06789](https://doi.org/10.48550/arXiv.2406.07285)). Additionally, the repository contains modules for generating pulse profiles using the X-PSI software.

## Software dependencies
The ``Pulse_profile_comparison/waveform_comparison.ipynb`` notebook requires python3 to run. 
The python files and notebooks in ``XPSI_Pulse_profile_reproduction`` require installation of the [X-PSI](https://github.com/xpsi-group/xpsi) software to run. The python files were created using X-PSI v2.1.0 and the pulse profile data synthesis notebooks were run using X-PSI v2.2.2. It is generally recommended to use up-to-date release versions of X-PSI.

## Data
The data required for running the ``Pulse_profile_comparison/waveform_comparison.ipynb`` notebook to reproduce the comparisons between the different codes makes use of the following data files located in ``Pulse_profile_comparison/Pulse_profiles_by_diff_codes/``:

* X-PSI data files:

    There are multiple data files generated using different X-PSI resolution settings for the different configurations explored in the paper. The data files corresponding to any given resolution setting are in their own subdirectory that has been indicated in the path name below using the placeholder ``<resolution>``. Each file has 3 columns corresponding to the instrument energy channel, phase bin, and the associated number of X-ray photon counts respectively.
    - ``XPSI/<resolution>/Ring_Eq_expected_hreadable.dat`` = Pulse profile data for the ``Ring_Eq`` configuration.
    - ``XPSI/<resolution>/Ring_Polar_expected_hreadable.dat`` = Pulse profile data for the ``Ring_Polar`` configuration.
    - ``XPSI/<resolution>/Crescent_Eq_expected_hreadable.dat`` = Pulse profile data for the ``Crescent_Eq`` configuration.
    - ``XPSI/<resolution>/Crescent_Polar_expected_hreadable.dat`` = Pulse profile data for the ``Crescent_Polar`` configuration.
    - ``XPSI/<resolution>/Bithermal_expected_hreadable.dat`` = Pulse profile data for the ``Bithermal`` configuration.

* IM data files:

    The 1st, 2nd and 4th columns in each file correspond to the instrument energy channel, phase bin, and the associated number of X-ray photon counts respectively.
    - ``IM/Ring_Eq.txt`` = Pulse profile data for the ``Ring_Eq`` configuration.
    - ``IM/Ring_Polar.txt`` = Pulse profile data for the ``Ring_Polar`` configuration.
    - ``IM/Crescent_Eq.txt`` = Pulse profile data for the ``Crescent_Eq`` configuration.
    - ``IM/Crescent_Polar.txt`` = Pulse profile data for the ``Crescent_Polar`` configuration.
    - ``IM/Bithermal.txt`` = Pulse profile data for the ``Bithermal`` configuration.

* Alberta data files:

    The 1st, 2nd and 3rd columns in each file correspond to the instrument energy channel, phase bin, and the associated number of X-ray photon counts respectively.
    - ``Alberta/Ring_Eq.txt`` = Pulse profile data for the ``Ring_Eq`` configuration.
    - ``Alberta/Ring_Polar.txt`` = Pulse profile data for the ``Ring_Polar`` configuration.
    - ``Alberta/Crescent_Eq.txt`` = Pulse profile data for the ``Crescent_Eq`` configuration.
    - ``Alberta/Crescent_Polar.txt`` = Pulse profile data for the ``Crescent_Polar`` configuration.
    - ``Alberta/Bithermal.txt`` = Pulse profile data for the ``Bithermal`` configuration.
 
The X-PSI pulse profile reproduction package relies on the following data files available in this [Zenodo repository](https://zenodo.org/records/13133748).

## Figures

The figures of the publication, corresponding to this repository, can be reproduced using the notebooks found here. Once the repository has been downloaded and X-PSI installed, these notebooks can be run without further changes. Here we list which notebooks should be executed to produce each of them (the pre-executed figures can also be viewed in the notebooks). Note that the notebooks also contain additional figures, not reported in the paper, to aid with further exploration. The cell blocks to be executed to obtain the figures in the paper have been described in in-line markdown cells. Note that the numbers mentioned below correspond to the figure labels in the arXiv version of the paper.
* ``XPSI_Pulse_profile_reproduction/ST_waveforms.ipynb``: Figure 9 (Appendix figure).
* ``Pulse_profile_comparison/waveform_comparison.ipynb``: Figure 2-8.

We have also provided full animations of the hotspot geometries corresponding to the snapshots shown in figure 1 in [Zenodo](https://zenodo.org/records/13133748).

## Contact
If you have questions, comments, or requests, please contact:
Devarshi Choudhury, D.Choudhury@uva.nl,
(in cc) Anna L. Watts, A.L.Watts@uva.nl
